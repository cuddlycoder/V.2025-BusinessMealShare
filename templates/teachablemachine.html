<!DOCTYPE html>
<html>
<head>
    <title>Teachable Machine Image Classifier</title>
</head>
<body>
    <h1>Teachable Machine Image Model</h1>
    
    <input type="file" id="imageUpload" accept="image/*">
    <br><br>
    
    <img id="previewImage" style="max-width: 300px; display: none;">
    <br><br>
    
    <div id="result"></div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
    
    <script>
        const URL = "https://teachablemachine.withgoogle.com/models/V8FHtn2Rp/";
        let model;
        
        // Load model
        async function loadModel() {
            model = await tmImage.load(URL + "model.json", URL + "metadata.json");
        }
        
        // Load model when page starts
        loadModel();
        
        // Handle file upload
        document.getElementById('imageUpload').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Show image
            const img = document.getElementById('previewImage');
            img.src = window.URL.createObjectURL(file);
            img.style.display = 'block';
            
            // Wait for image to load, then predict
            img.onload = async function() {
                const predictions = await model.predict(img);
                
                // Find highest prediction
                let topPrediction = predictions[0];
                for (let i = 1; i < predictions.length; i++) {
                    if (predictions[i].probability > topPrediction.probability) {
                        topPrediction = predictions[i];
                    }
                }
                
                // Show result
                document.getElementById('result').innerHTML = 
                    `This is: <strong>${topPrediction.className}</strong> (${(topPrediction.probability * 100).toFixed(1)}% confident)`;
            };
        });
    </script>
</body>
</html>